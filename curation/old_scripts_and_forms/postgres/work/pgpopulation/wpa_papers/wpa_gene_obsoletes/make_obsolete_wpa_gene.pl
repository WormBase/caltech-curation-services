#!/usr/bin/perl -w

# take Mary Ann's list and make old genes invalid and assign to new genes.  2006 09 30

use strict;
use diagnostics;
use Pg;

my $conn = Pg::connectdb("dbname=testdb");
die $conn->errorMessage unless PGRES_CONNECTION_OK eq $conn->status;

my $infile = 'dead_genes_references.txt';
open (IN, "<$infile") or die "Cannot open $infile : $!";
while (my $line = <IN>) {
  chomp $line;
  my ($old, $new, $paper) = split/\t/, $line;
  $paper =~ s/WBPaper//;
  my $pgcommand = "INSERT INTO wpa_gene VALUES ('$paper', '$old', 'Inferred_automatically \"Mary Ann Tuli dead and merged gene dump 2006 09 29\"', 'invalid', 'two480', CURRENT_TIMESTAMP);";
  print "$pgcommand\n";
  my $result = $conn->exec( $pgcommand );
  $pgcommand = "INSERT INTO wpa_gene VALUES ('$paper', '$new', 'Inferred_automatically \"Mary Ann Tuli dead and merged gene dump 2006 09 29\"', 'valid', 'two480', CURRENT_TIMESTAMP);";
  print "$pgcommand\n";
  $result = $conn->exec( $pgcommand );
} # while (my $line = <IN>)
close (IN) or die "Cannot open $infile : $!";


my $result = $conn->exec( "SELECT * FROM one_groups;" );
while (my @row = $result->fetchrow) {
  if ($row[0]) { 
    $row[0] =~ s///g;
    $row[1] =~ s///g;
    $row[2] =~ s///g;
    print "$row[0]\t$row[1]\t$row[2]\n";
  } # if ($row[0])
} # while (@row = $result->fetchrow)

__END__

WBGene00000394	WBGene00019994	WBPaper00003990
WBGene00000394	WBGene00019994	WBPaper00004508
WBGene00000394	WBGene00019994	WBPaper00005214
WBGene00000394	WBGene00019994	WBPaper00010111
WBGene00000394	WBGene00019994	WBPaper00011717
WBGene00000394	WBGene00019994	WBPaper00013424
WBGene00000394	WBGene00019994	WBPaper00021991
WBGene00000394	WBGene00019994	WBPaper00022625
WBGene00000400	WBGene00017576	WBPaper00004508
WBGene00000400	WBGene00017576	WBPaper00013424
WBGene00000400	WBGene00017576	WBPaper00018119
WBGene00000404	WBGene00022103	WBPaper00004508
WBGene00000404	WBGene00022103	WBPaper00013424
WBGene00000404	WBGene00022103	WBPaper00026643
WBGene00001138	WBGene00001173	WBPaper00001709
WBGene00001138	WBGene00001173	WBPaper00003257
WBGene00001138	WBGene00001173	WBPaper00004217
WBGene00001138	WBGene00001173	WBPaper00004883
WBGene00001138	WBGene00001173	WBPaper00005211
WBGene00001138	WBGene00001173	WBPaper00010745
WBGene00001138	WBGene00001173	WBPaper00025522
WBGene00001138	WBGene00001173	WBPaper00026046
WBGene00001370	WBGene00017644	WBPaper00003721
WBGene00001370	WBGene00017644	WBPaper00012523
WBGene00001370	WBGene00017644	WBPaper00019619
WBGene00001370	WBGene00017644	WBPaper00026207
WBGene00001504	WBGene00009882	WBPaper00019570
WBGene00001504	WBGene00009882	WBPaper00024113
WBGene00001504	WBGene00009882	WBPaper00026591
WBGene00001610	WBGene00001168	WBPaper00002649
WBGene00001610	WBGene00001168	WBPaper00003990
WBGene00001610	WBGene00001168	WBPaper00005046
WBGene00001610	WBGene00001168	WBPaper00006401
WBGene00001610	WBGene00001168	WBPaper00010589
WBGene00001610	WBGene00001168	WBPaper00012606
WBGene00001610	WBGene00001168	WBPaper00018646
WBGene00001610	WBGene00001168	WBPaper00021859
WBGene00001610	WBGene00001168	WBPaper00024924
WBGene00001634	WBGene00012934	WBPaper00003042
WBGene00001634	WBGene00012934	WBPaper00005408
WBGene00001634	WBGene00012934	WBPaper00017620
WBGene00001634	WBGene00012934	WBPaper00026630
WBGene00001797	WBGene00004273	WBPaper00010884
WBGene00001797	WBGene00004273	WBPaper00014892
WBGene00001797	WBGene00004273	WBPaper00019554
WBGene00001797	WBGene00004273	WBPaper00025619
WBGene00002277	WBGene00003026	WBPaper00002950
WBGene00002277	WBGene00003026	WBPaper00003418
WBGene00002277	WBGene00003026	WBPaper00003780
WBGene00002277	WBGene00003026	WBPaper00004116
WBGene00002277	WBGene00003026	WBPaper00004144
WBGene00002277	WBGene00003026	WBPaper00004389
WBGene00002277	WBGene00003026	WBPaper00011181
WBGene00002277	WBGene00003026	WBPaper00014318
WBGene00002277	WBGene00003026	WBPaper00015631
WBGene00002277	WBGene00003026	WBPaper00017745
WBGene00002277	WBGene00003026	WBPaper00022146
WBGene00002277	WBGene00003026	WBPaper00022278
WBGene00002277	WBGene00003026	WBPaper00022838
WBGene00002277	WBGene00003026	WBPaper00023811
WBGene00002277	WBGene00003026	WBPaper00026477
WBGene00002277	WBGene00003026	WBPaper00026492
WBGene00003276	WBGene00003039	WBPaper00004927
WBGene00003276	WBGene00003039	WBPaper00005825
WBGene00003276	WBGene00003039	WBPaper00005879
WBGene00003276	WBGene00003039	WBPaper00006075
WBGene00003276	WBGene00003039	WBPaper00010853
WBGene00003276	WBGene00003039	WBPaper00018981
WBGene00003276	WBGene00003039	WBPaper00019534
WBGene00003276	WBGene00003039	WBPaper00019714
WBGene00003276	WBGene00003039	WBPaper00025627
WBGene00003276	WBGene00003039	WBPaper00026043
WBGene00003276	WBGene00003039	WBPaper00026424
WBGene00003276	WBGene00003039	WBPaper00026716
WBGene00003276	WBGene00003039	WBPaper00026780
WBGene00003276	WBGene00003039	WBPaper00026781
WBGene00003276	WBGene00003039	WBPaper00026854
WBGene00003817	WBGene00007799	WBPaper00023973
WBGene00003820	WBGene00002987	WBPaper00024145
WBGene00003820	WBGene00002987	WBPaper00026206
WBGene00003823	WBGene00006575	WBPaper00003760
WBGene00003823	WBGene00006575	WBPaper00006052
WBGene00003823	WBGene00006575	WBPaper00016967
WBGene00003823	WBGene00006575	WBPaper00017112
WBGene00003823	WBGene00006575	WBPaper00019278
WBGene00003823	WBGene00006575	WBPaper00024131
WBGene00003823	WBGene00006575	WBPaper00024676
WBGene00003823	WBGene00006575	WBPaper00025180
WBGene00003823	WBGene00006575	WBPaper00025467
WBGene00004280	WBGene00000089	WBPaper00015788
WBGene00004280	WBGene00000089	WBPaper00026185
WBGene00004280	WBGene00000089	WBPaper00027296
WBGene00004325	WBGene00003499	WBPaper00003711
WBGene00004325	WBGene00003499	WBPaper00003763
WBGene00004325	WBGene00003499	WBPaper00003918
WBGene00004325	WBGene00003499	WBPaper00004173
WBGene00004325	WBGene00003499	WBPaper00004325
WBGene00004325	WBGene00003499	WBPaper00004476
WBGene00004325	WBGene00003499	WBPaper00004507
WBGene00004325	WBGene00003499	WBPaper00004549
WBGene00004325	WBGene00003499	WBPaper00005368
WBGene00004325	WBGene00003499	WBPaper00005667
WBGene00004325	WBGene00003499	WBPaper00010533
WBGene00004325	WBGene00003499	WBPaper00018767
WBGene00004325	WBGene00003499	WBPaper00024516
WBGene00004325	WBGene00003499	WBPaper00024972
WBGene00004325	WBGene00003499	WBPaper00025139
WBGene00004325	WBGene00003499	WBPaper00026007
WBGene00004325	WBGene00003499	WBPaper00026973
WBGene00004325	WBGene00003499	WBPaper00027111
WBGene00004325	WBGene00003499	WBPaper00027312
WBGene00004327	WBGene00006914	WBPaper00018957
WBGene00004327	WBGene00006914	WBPaper00025997
WBGene00004396	WBGene00005018	WBPaper00000465
WBGene00004396	WBGene00005018	WBPaper00000608
WBGene00004396	WBGene00005018	WBPaper00001639
WBGene00004396	WBGene00005018	WBPaper00001692
WBGene00004396	WBGene00005018	WBPaper00003289
WBGene00004396	WBGene00005018	WBPaper00006388
WBGene00004396	WBGene00005018	WBPaper00013730
WBGene00004396	WBGene00005018	WBPaper00013885
WBGene00004396	WBGene00005018	WBPaper00014385
WBGene00004396	WBGene00005018	WBPaper00014687
WBGene00004396	WBGene00005018	WBPaper00015510
WBGene00004396	WBGene00005018	WBPaper00015832
WBGene00004396	WBGene00005018	WBPaper00015974
WBGene00004396	WBGene00005018	WBPaper00016149
WBGene00004396	WBGene00005018	WBPaper00016210
WBGene00004396	WBGene00005018	WBPaper00018954
WBGene00004396	WBGene00005018	WBPaper00021003
WBGene00004733	WBGene00000998	WBPaper00003665
WBGene00004733	WBGene00000998	WBPaper00025328
WBGene00006317	WBGene00004897	WBPaper00018307
WBGene00006469	WBGene00003400	WBPaper00027258
WBGene00006548	WBGene00004750	WBPaper00024194
WBGene00006847	WBGene00006747	WBPaper00002440
WBGene00006847	WBGene00006747	WBPaper00002950
WBGene00006879	WBGene00006893	WBPaper00024022
WBGene00006909	WBGene00003134	WBPaper00015695
WBGene00006909	WBGene00003134	WBPaper00018142
WBGene00006909	WBGene00003134	WBPaper00023148
WBGene00007879	WBGene00006462	WBPaper00023570
WBGene00008004	WBGene00003210	WBPaper00026391
WBGene00008004	WBGene00003210	WBPaper00026722
WBGene00009074	WBGene00000906	WBPaper00015745
WBGene00010860	WBGene00001121	WBPaper00027258
WBGene00011118	WBGene00011116	WBPaper00026830
WBGene00011138	WBGene00044330	WBPaper00011544
WBGene00011138	WBGene00044330	WBPaper00026656
WBGene00011316	WBGene00011315	WBPaper00026753
WBGene00011863	WBGene00007047	WBPaper00004340
WBGene00012800	WBGene00012802	WBPaper00005736
WBGene00012865	WBGene00003582	WBPaper00026846
WBGene00013309	WBGene00000192	WBPaper00027296
WBGene00013377	WBGene00003142	WBPaper00025480
WBGene00013990	WBGene00013992	WBPaper00026601
WBGene00013992	WBGene00001118	WBPaper00005736
WBGene00014211	WBGene00006367	WBPaper00017665
WBGene00016672	WBGene00000402	WBPaper00018119
WBGene00016969	WBGene00006522	WBPaper00015815
WBGene00017346	WBGene00006893	WBPaper00024022
WBGene00018306	WBGene00018304	WBPaper00019346
WBGene00018790	WBGene00001117	WBPaper00026601
WBGene00019500	WBGene00000998	WBPaper00001332
WBGene00019500	WBGene00000998	WBPaper00010582
WBGene00019500	WBGene00000998	WBPaper00010913
WBGene00019500	WBGene00000998	WBPaper00010923
WBGene00019500	WBGene00000998	WBPaper00011180
WBGene00019500	WBGene00000998	WBPaper00014526
WBGene00019500	WBGene00000998	WBPaper00014724
WBGene00019500	WBGene00000998	WBPaper00014791
WBGene00019500	WBGene00000998	WBPaper00015166
WBGene00019500	WBGene00000998	WBPaper00015171
WBGene00019500	WBGene00000998	WBPaper00015358
WBGene00019500	WBGene00000998	WBPaper00018229
WBGene00019500	WBGene00000998	WBPaper00021719
WBGene00019500	WBGene00000998	WBPaper00022001
WBGene00019500	WBGene00000998	WBPaper00022079
WBGene00019500	WBGene00000998	WBPaper00022671
WBGene00019500	WBGene00000998	WBPaper00023024
WBGene00019500	WBGene00000998	WBPaper00024818
WBGene00019500	WBGene00000998	WBPaper00024820
WBGene00019500	WBGene00000998	WBPaper00025328
WBGene00019500	WBGene00000998	WBPaper00026504
WBGene00019500	WBGene00000998	WBPaper00027316
WBGene00020965	WBGene00020964	WBPaper00011578
WBGene00020965	WBGene00020964	WBPaper00023748
WBGene00021064	WBGene00044319	WBPaper00015846
WBGene00021824	WBGene00003258	WBPaper00026979
WBGene00021825	WBGene00003258	WBPaper00026979
WBGene00022784	WBGene00044324	WBPaper00005435
